<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Spider Klipper Firmware - </title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Spider Klipper Firmware | Gadget Angel Voron Documentation</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Spider Klipper Firmware" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Voron Official and Community Documentation" /> <meta property="og:description" content="Voron Official and Community Documentation" /> <link rel="canonical" href="http://localhost:4000/build/software/spider_klipper.html" /> <meta property="og:url" content="http://localhost:4000/build/software/spider_klipper.html" /> <meta property="og:site_name" content="Gadget Angel Voron Documentation" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Spider Klipper Firmware" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Voron Official and Community Documentation","headline":"Spider Klipper Firmware","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/voron_design_logo.png"}},"url":"http://localhost:4000/build/software/spider_klipper.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Voron Documentation</a></li><li class="nav-list-item"><a href="http://localhost:4000/about.html" class="nav-list-link">About Voron</a></li><li class="nav-list-item"><a href="http://localhost:4000/hardware.html" class="nav-list-link">Choosing a Printer / Extruder</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/sourcing.html" class="nav-list-link">Sourcing Information</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/materials.html" class="nav-list-link">Materials Selection</a></li><li class="nav-list-item "><a href="http://localhost:4000/sourcing_faq.html" class="nav-list-link">Sourcing / Buying FAQ</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/build/" class="nav-list-link">The Build</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/build/mechanical/" class="nav-list-link">Mechanical Assembly</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/build/electrical/" class="nav-list-link">Electrical Wiring</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/build/software/" class="nav-list-link">Software Installation</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/build/software/installing_mainsail.html" class="nav-list-link">Installing Mainsail</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/build/software/installing_fluidd.html" class="nav-list-link">Installing Fluidd</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/build/software/installing_octoprint.html" class="nav-list-link">Installing Octoprint</a> </li></ul></li><li class="nav-list-item "><a href="http://localhost:4000/build/software/configuration.html" class="nav-list-link">Software Configuration</a></li><li class="nav-list-item "><a href="http://localhost:4000/build/startup/" class="nav-list-link">Initial Startup</a></li><li class="nav-list-item "><a href="http://localhost:4000/build/slicer/" class="nav-list-link">Slicer Setup</a></li><li class="nav-list-item "><a href="http://localhost:4000/build/slicer/first_print.html" class="nav-list-link">First Print</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/tuning/" class="nav-list-link">Tuning Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/tuning/secondary_printer_tuning.html" class="nav-list-link">Secondary Printer Tuning</a></li><li class="nav-list-item "><a href="http://localhost:4000/tuning/filament_tuning.html" class="nav-list-link">Filament Tuning</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/maintenance.html" class="nav-list-link">Maintenance Guide</a></li><li class="nav-list-item"><a href="http://localhost:4000/history.html" class="nav-list-link">Voron History</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/community/" class="nav-list-link">Community Documentation</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/community/howto/" class="nav-list-link">How-To's</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/troubleshooting/" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/electronics/" class="nav-list-link">Alternate Electronics</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/macros/" class="nav-list-link">Custom Macros</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/video_guides.html" class="nav-list-link">Video Guides</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/resources.html" class="nav-list-link">Other Resources</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/support/submission_information.html" class="nav-list-link">Community Submission Information</a></li><li class="nav-list-item "><a href="http://localhost:4000/community/support/pull_request_guide.html" class="nav-list-link">Pull Request Guide</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search " aria-label="Search " autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/GadgetAngel/GA-Voron-Documentation" class="site-button" > Voron Documentation on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="https://gadgetangel.org" class="site-button" > VoronDesign Home </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="spider-klipper-firmware"> <a href="#spider-klipper-firmware" class="anchor-heading" aria-labelledby="spider-klipper-firmware"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Spider Klipper Firmware </h1> <p>The firmware installation process for the Fysetc Spider MCU.</p> <h3 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h3> <ul> <li>Klipper must be installed onto the Raspberry Pi</li> <li>It is desirable, though not strictly necessary to have a small sdcard available</li> <li>Even if you intend to power your Pi with the Spider, during this flashing process, you will find it far more convenient to power your pi from some other source, such as a regular USB power supply</li> <li>Voron Design recommends using USB to control the Spider, which simply requires connecting a USB-A to USB-C cable between the Spider and Pi. If you prefer a UART connection, please consult the fysetc documentation for the necessary configuration adjustments</li> </ul> <h3 id="build-firmware-image"> <a href="#build-firmware-image" class="anchor-heading" aria-labelledby="build-firmware-image"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Build Firmware Image </h3> <ul> <li>Login to the Raspberry Pi via ssh</li> <li> <p>Run the following:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sudo apt install make
 cd ~/klipper
 make clean
 make menuconfig
</code></pre></div> </div> </li> <li>In the menu structure there are a number of items to be selected. <ul> <li>Select “Enable extra low-level configuration options”</li> <li>Set the micro-controller architecture is set to <code class="language-plaintext highlighter-rouge">STMicroelectronics STM32</code></li> <li>Set the Processor model to <code class="language-plaintext highlighter-rouge">STM32F446</code></li> <li>If your Spider was made after <code class="language-plaintext highlighter-rouge">2021/06/23</code>, Set the Bootloader offset to <code class="language-plaintext highlighter-rouge">32KiB bootloader</code></li> <li>If your Spider was made prior to <code class="language-plaintext highlighter-rouge">2021/06/23</code>, Set the Bootloader offset to <code class="language-plaintext highlighter-rouge">64KiB bootloader</code></li> <li>Set the Clock Reference to <code class="language-plaintext highlighter-rouge">12 MHz crystal</code></li> <li>Set the Communication interface to <code class="language-plaintext highlighter-rouge">USB (on PA11/PA12)</code> (note: see Fysetc documentation if you intend to use UART rather than USB)</li> </ul> <p><img src="/build/software/images/spider_klipper_menuconfig.png" alt="" /></p> </li> <li> <p>Once the configuration is selected, press <code class="language-plaintext highlighter-rouge">q</code> to exit, and “Yes” when asked to save the configuration.</p> </li> <li>Run the command <code class="language-plaintext highlighter-rouge">make</code></li> <li>The <code class="language-plaintext highlighter-rouge">make</code> command, when completed, creates a firmware file <strong>klipper.bin</strong> that is store in the folder <code class="language-plaintext highlighter-rouge">/home/pi/klipper/out</code>.</li> </ul> <p>There are multiple options for getting this firmware file installed onto your Spider.</p> <h3 id="firmware-installation"> <a href="#firmware-installation" class="anchor-heading" aria-labelledby="firmware-installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Firmware Installation </h3> <h4 id="option-1-dfu-firmware-install"> <a href="#option-1-dfu-firmware-install" class="anchor-heading" aria-labelledby="option-1-dfu-firmware-install"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Option 1: DFU Firmware Install </h4> <ul> <li>Requires a USB connection</li> <li>Requires the installation of an extra jumper on the Spider</li> <li>Does NOT require an sdcard</li> </ul> <ol> <li>Power off the Spider</li> <li>Install a jumper between BT0 and 3.3V</li> <li>Connect Spider &amp; Pi via USB</li> <li>Power on Spider</li> <li>from your ssh session, run <code class="language-plaintext highlighter-rouge">lsusb</code>. and find the ID of the dfu device.</li> <li>run <code class="language-plaintext highlighter-rouge">make flash FLASH_DEVICE=1234:5678</code> replace 1234:5678 with the ID from the previous step</li> <li>power off the Spider</li> <li>remove the jumper from BT0/3.3V</li> <li>Power up the Spider</li> <li>you can confirm that the flash was successful, by running <code class="language-plaintext highlighter-rouge">ls /dev/serial/by-id</code>. if the flash was successful, this should now show a klipper device, similar to:</li> </ol> <p><img src="/build/software/images/stm32f446_id.png" alt="" /></p> <p>(note: this test is not appicable if the firmware was compiled for UART, rather than USB)</p> <h4 id="option-2-sdcard-firmware-install"> <a href="#option-2-sdcard-firmware-install" class="anchor-heading" aria-labelledby="option-2-sdcard-firmware-install"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Option 2: SDcard Firmware Install </h4> <ul> <li>Works regardless of USB vs UART</li> <li>Requires a microSD card</li> </ul> <ol> <li> <p>Use a tool such as cyberduck or winscp to copy the klipper.bin file off your pi, onto your computer.</p> <p><img src="/build/software/images/cyberduck_example.png" alt="" /></p> </li> <li> <p>Rename <strong>klipper.bin</strong> to <strong>firmware.bin</strong></p> </li> </ol> <p><strong>Important:</strong> If the file is not renamed, the bootloader will not be updated properly.</p> <ol> <li>Ensure that your sdcard is formatted FAT32 (NOT EXFAT!)</li> <li>copy <strong>firmware.bin</strong> onto the microSD card (if this card has previously been used for this process, remove all old firmware.bin and old.bin files)</li> <li>power down the Spider</li> <li>insert the microSD card</li> <li>power on the Spider</li> <li>after a few seconds, the Spider should be flashed</li> <li> <p>you can confirm that the flash was successful, by running <code class="language-plaintext highlighter-rouge">ls /dev/serial/by-id</code>. if the flash was successful, this should now show a klipper device, similar to:</p> <p><img src="/build/software/images/stm32f446_id.png" alt="" /></p> </li> </ol> <p>(note: this test is not appicable if the firmware was compiled for UART, rather than USB)</p> <p><strong>Important:</strong> If the Spider is not powered with 12-24V, Klipper will be unable to communicate with the TMC drivers via UART and the Spider will automatically shut down.</p> <h3 id="back-to-software-installation"> <a href="#back-to-software-installation" class="anchor-heading" aria-labelledby="back-to-software-installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Back to <a href="/build/software/#klipper-octoprint-configuration">Software Installation</a> </h3> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
